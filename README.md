# Rag: Rates and Gifs

## Условия

Создать сервис, который обращается к сервису курсов валют, и отображает gif:
- если курс по отношению к USD за сегодня стал выше вчерашнего, то отдаем рандомную отсюда https://giphy.com/search/rich
- если ниже - отсюда https://giphy.com/search/broke

Ссылки
REST API курсов валют - https://docs.openexchangerates.org/
REST API гифок - https://developers.giphy.com/docs/api#quick-start-guide

Сервис на Spring Boot 2 + Java / Kotlin
Запросы приходят на HTTP endpoint (должен быть написан в соответствии с rest conventions), туда передается код валюты по отношению с которой сравнивается USD
Для взаимодействия с внешними сервисами используется Feign
Все параметры (валюта по отношению к которой смотрится курс, адреса внешних сервисов и т.д.) вынесены в настройки
На сервис написаны тесты (для мока внешних сервисов можно использовать @mockbean или WireMock)
Для сборки должен использоваться Gradle
Результатом выполнения должен быть репо на GitHub с инструкцией по запуску

## Описание и инструкция

Приложение последовательно запрашивает данные с сервисов https://docs.openexchangerates.org и https://giphy.com и открывает веб-страницу с gif-изображением. Результат выдачи зависит от изменения курса валюты за период между последней выдачей и количеством дней, указанным в параметрах (yml).

Приложению не требуются явные указания, всё необходимое прописано в yml. Однако возможна доработка для кастомизации запроса самим пользователем, выдачи gif-изображения другого формата и т.д.

Сразу после запуска приложение отправляет запрос на localhost, перехватываемый Rest-контролером. Веб-служба получает от остальных служб параметры и последовательно отправляет запросы на указанные сервисы через Feign-клиенты. Далее приложение рассчитывает параметры для запроса gif-изображения, получает его и открывает системный веб-браузер с помощью JavaFX для выдачи пользователю результата. Приложение самостоятельно показывает польователю gif, если "app:mode=auto" (yml). В ином случае приложение выдаёт в командной строке ссылку на веб-страницу с gif-изображением.

Для тестов feign-клиентов использован Wiremock.

Значения base и symbols в параметрах (yml) соответвуют значениям, определённым сервисом https://docs.openexchangerates.org. В symbols возможно добавить несколько валют либо оставить поле пустым. В этих случаях приложение рассчитывает курс валют как среднее арифметическое.

Помимо основных параметров в приложение (yml) добавлено дефолтное значение количества дней между датами первого и второго запроса курсов валют. Если оставить значение 1 (день), то вероятна ошибка при работе приложения сразу после смены дат, когда сервис выдачи курсов валют ещё не обновил данные. Другой вариант - добавить логику выдачи более ранных курсов.

Сборка и запуск - стандартное Gradle-приложение

Приложение запускается и работает в Docker-контейнере, но, к сожалению, без доступа к внешнему браузеру выбрасывает исключение. Возможные решения - обеспечить доступ к браузеру либо засунуть браузер в контейнер, либо добавить в приложение собственный браузер, либо показывать пользователю только копию gif-изображения, полученного с сайта.
